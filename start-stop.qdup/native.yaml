scripts:
  ensure-quarkus-cli:
  - sh: quarkus version #to see if the command exists
    then:
    - regex: command not found
      then:
      - sh: "curl -Ls https://sh.jbang.dev | bash -s - trust add https://repo1.maven.org/maven2/io/quarkus/quarkus-cli/"
      - sh: "curl -Ls https://sh.jbang.dev | bash -s - app install --fresh --force quarkus@quarkusio"
  ensure-graalvm:
  - sh: /tmp/quarkus-quickstarts/getting-started/graalvm-ce-java17-22.3.1/bin/native-image --version #to see if the command exists
    then:
    - regex: command not found
      then:
      - sh: "bash <(curl -sL https://get.graalvm.org/jdk)"
  getting-started:
  - sh: cd /tmp/
  - sh: "[[ ! -d quarkus-quickstarts ]] && git clone https://github.com/quarkusio/quarkus-quickstarts.git"
  - sh: cd quarkus-quickstarts
  - sh: cd getting-started
  - script: ensure-graalvm
  - script: ensure-quarkus-cli
  - sh:
      command: JAVA_HOME=/tmp/quarkus-quickstarts/getting-started/graalvm-ce-java17-22.3.1 quarkus build --native
hosts:
  test: testuser@test
roles:
  example:
    hosts:
    - test
    run-scripts:
    - getting-started
